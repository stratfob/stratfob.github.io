<!DOCTYPE html>
<html>
<head>
	<title>Boggle</title>
	<script src="https://www.gstatic.com/firebasejs/5.5.0/firebase.js"></script>
	<script src="https://www.gstatic.com/firebasejs/5.4.1/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/5.4.1/firebase-database.js"></script>
	<script src="https://www.gstatic.com/firebasejs/5.4.1/firebase-functions.js"></script>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

	<script>
		// Initialize Firebase
		var config = {
			apiKey: "AIzaSyCKeL1HQw6RZwdo0bbI4JcVgA26_i2DFXQ",
			authDomain: "boggle-d92fc.firebaseapp.com",
			databaseURL: "https://boggle-d92fc.firebaseio.com",
			projectId: "boggle-d92fc",
			storageBucket: "",
			messagingSenderId: "853715485148"
		};
		firebase.initializeApp(config);

	</script>
	<script src="js/dictionary.js"></script>
</head>

<body>
<div class="accordion" id="accordionExample">
</div>
</div>
	<script type="text/javascript">

		function showScore(id){
			document.getElementById(id).style.display="none";
			document.getElementById(id+"Score").style.display="block";
		}

		var i = 0;
		var query = firebase.database().ref("games").orderByKey();
		query.once("value")
			.then(function(snapshot) {
			snapshot.forEach(function(childSnapshot) {
				var key = childSnapshot.key;
				var childData = childSnapshot.val();
				var players = firebase.database().ref("games/"+key+"/players");
				var playerList = [];
				players.once("value").then(function(snap) {
					document.getElementById("accordionExample").innerHTML += 
					"<div class='card'>" + 
					"<div class='card-header' id='heading" + i + "'>" + 
						"<h5 class='mb-0'>"+
							"<button class='btn btn-link collapsed' type='button' data-toggle='collapse' data-target='#collapse" + i + "' aria-expanded='false' aria-controls='collapse" + i + "'>"+
								key +
							"</button>"+
						"</h5>"+
					"</div>";
					var j = 0;
					snap.forEach(function(childSnap) {
						playerList.push(JSON.stringify(childSnap.val().username).substring(1, JSON.stringify(childSnap.val().username).length - 1));
						document.getElementById("accordionExample").innerHTML += 
						"<div id='collapse" + i + "' class='collapse' aria-labelledby='heading" + i + "' data-parent='#accordionExample'>"+
							"<div class='card-body'>"+
								playerList[j]+"<button id='showScore"+i+""+j+"' style='display: block;' onclick=\"showScore('showScore"+i+""+j+"\')\">Show Score</button>"+
								"<p id = 'showScore"+i+""+j+"Score' style='display: none;'>"+ 
								JSON.stringify(childSnap.val().score)
								+"</p>"+
							"</div>"+
						"</div>";
						j++;
					});
					document.getElementById("accordionExample").innerHTML += "</div>";
					i++;
				});
				
			});
		});
	</script>
</body>